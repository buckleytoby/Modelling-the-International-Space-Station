<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="2,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S2T8U3">RTN_triad</span> = getRTNTriadfromState(<span class="var type1" id="S3T1U6">state</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="2,2" id="srcline2"> 2</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="2,3" id="srcline3"> 3</a></span><span class="line"><span class="comment">% R direction in xECI</span></span></span>
<span class="srcline"><span class="lineno"><a href="2,4" id="srcline4"> 4</a></span><span class="line"><span class="mxinfo " id="T2:U3"><span class="var type1" id="S4T2U9">xECI</span> = <span class="mxinfo " id="T2:U5"><span class="var type1" id="S3T1U11">state</span>(1:3)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="2,5" id="srcline5"> 5</a></span><span class="line"><span class="mxinfo " id="T2:U7"><span class="var type1" id="S5T2U17">R</span> = <span class="mxinfo " id="T2:U9"><span class="var type1" id="S4T2U19">xECI</span> / <span class="mxinfo " id="T3:U11">norm(<span class="var type1" id="S4T2U22">xECI</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="2,6" id="srcline6"> 6</a></span><span class="line"><span class="comment">% not quite T in vel direction</span></span></span>
<span class="srcline"><span class="lineno"><a href="2,7" id="srcline7"> 7</a></span><span class="line"><span class="mxinfo " id="T2:U13"><span class="var type1" id="S7T2U25">vECI</span> = <span class="mxinfo " id="T2:U15"><span class="var type1" id="S3T1U27">state</span>(4:6)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="2,8" id="srcline8"> 8</a></span><span class="line"><span class="mxinfo " id="T2:U17"><span class="var type1" id="S8T2U33">not_T</span> = <span class="mxinfo " id="T2:U19"><span class="var type1" id="S7T2U35">vECI</span> / <span class="mxinfo " id="T3:U21">norm(<span class="var type1" id="S7T2U38">vECI</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="2,9" id="srcline9"> 9</a></span><span class="line"><span class="comment">% N is the cross product</span></span></span>
<span class="srcline"><span class="lineno"><a href="2,10" id="srcline10">10</a></span><span class="line"><span class="mxinfo " id="T2:U23"><span class="var type1" id="S9T2U41">N</span> = <span class="mxinfo " id="T2:U25">cross(<span class="var type1" id="S5T2U44">R</span>, <span class="var type1" id="S8T2U45">not_T</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="2,11" id="srcline11">11</a></span><span class="line"><span class="comment">% get the actual T</span></span></span>
<span class="srcline"><span class="lineno"><a href="2,12" id="srcline12">12</a></span><span class="line"><span class="mxinfo " id="T2:U28"><span class="var type1" id="S11T2U48">T</span> = <span class="mxinfo " id="T2:U30">cross(<span class="var type1" id="S9T2U51">N</span>, <span class="var type1" id="S5T2U52">R</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="2,13" id="srcline13">13</a></span><span class="line"><span class="mxinfo " id="T8:U33"><span class="var type1" id="S2T8U55">RTN_triad</span> = <span class="mxinfo " id="T8:U35">[<span class="var type1" id="S5T2U58">R</span>, <span class="var type1" id="S9T2U59">N</span>, <span class="var type1" id="S11T2U60">T</span>]</span></span>; <span class="comment">%should be 3x3 now</span></span></span>
<span class="srcline"><span class="lineno"><a href="2,14" id="srcline14">14</a></span><span class="line"><span class="keyword">end</span></span></span>
</pre>
