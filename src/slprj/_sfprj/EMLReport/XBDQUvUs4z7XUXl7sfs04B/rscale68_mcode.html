<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="43,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span>[<span class="var type1" id="S2T38U3">Nbar</span>]=rscale(<span class="var type1" id="S3T20U6">a</span>,<span class="var type1" id="S4T20U7">b</span>,<span class="var type1" id="S5T20U8">c</span>,<span class="var type1" id="S6T20U9">d</span>,<span class="var type1" id="S7T20U10">k</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="43,2" id="srcline2"> 2</a></span><span class="line"><span class="comment">% Given the single-input linear system:</span></span></span>
<span class="srcline"><span class="lineno"><a href="43,3" id="srcline3"> 3</a></span><span class="line"><span class="comment">%       .</span></span></span>
<span class="srcline"><span class="lineno"><a href="43,4" id="srcline4"> 4</a></span><span class="line"><span class="comment">%       x = Ax + Bu</span></span></span>
<span class="srcline"><span class="lineno"><a href="43,5" id="srcline5"> 5</a></span><span class="line"><span class="comment">%       y = Cx + Du</span></span></span>
<span class="srcline"><span class="lineno"><a href="43,6" id="srcline6"> 6</a></span><span class="line"><span class="comment">% and the feedback matrix K,</span></span></span>
<span class="srcline"><span class="lineno"><a href="43,7" id="srcline7"> 7</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="43,8" id="srcline8"> 8</a></span><span class="line"><span class="comment">% the function rscale(sys,K) or rscale(A,B,C,D,K)</span></span></span>
<span class="srcline"><span class="lineno"><a href="43,9" id="srcline9"> 9</a></span><span class="line"><span class="comment">% finds the scale factor N which will</span></span></span>
<span class="srcline"><span class="lineno"><a href="43,10" id="srcline10">10</a></span><span class="line"><span class="comment">% eliminate the steady-state error to a step reference</span></span></span>
<span class="srcline"><span class="lineno"><a href="43,11" id="srcline11">11</a></span><span class="line"><span class="comment">% for a continuous-time, single-input system</span></span></span>
<span class="srcline"><span class="lineno"><a href="43,12" id="srcline12">12</a></span><span class="line"><span class="comment">% with full-state feedback using the schematic below:</span></span></span>
<span class="srcline"><span class="lineno"><a href="43,13" id="srcline13">13</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="43,14" id="srcline14">14</a></span><span class="line"><span class="comment">%                         /---------\</span></span></span>
<span class="srcline"><span class="lineno"><a href="43,15" id="srcline15">15</a></span><span class="line"><span class="comment">%      R         +     u  | .       |</span></span></span>
<span class="srcline"><span class="lineno"><a href="43,16" id="srcline16">16</a></span><span class="line"><span class="comment">%      ---&gt; N ---&gt;() ----&gt;| X=Ax+Bu |--&gt; y=Cx ---&gt; y</span></span></span>
<span class="srcline"><span class="lineno"><a href="43,17" id="srcline17">17</a></span><span class="line"><span class="comment">%                -|       \---------/</span></span></span>
<span class="srcline"><span class="lineno"><a href="43,18" id="srcline18">18</a></span><span class="line"><span class="comment">%                 |             |</span></span></span>
<span class="srcline"><span class="lineno"><a href="43,19" id="srcline19">19</a></span><span class="line"><span class="comment">%                 |&lt;---- K &lt;----|</span></span></span>
<span class="srcline"><span class="lineno"><a href="43,20" id="srcline20">20</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="43,21" id="srcline21">21</a></span><span class="line"><span class="comment">%8/21/96 Yanjie Sun of the University of Michigan</span></span></span>
<span class="srcline"><span class="lineno"><a href="43,22" id="srcline22">22</a></span><span class="line"><span class="comment">%        under the supervision of Prof. D. Tilbury</span></span></span>
<span class="srcline"><span class="lineno"><a href="43,23" id="srcline23">23</a></span><span class="line"><span class="comment">%6/12/98 John Yook, Dawn Tilbury revised</span></span></span>
<span class="srcline"><span class="lineno"><a href="43,24" id="srcline24">24</a></span><span class="line">error(nargchk(2,5,nargin));</span></span>
<span class="srcline"><span class="lineno"><a href="43,25" id="srcline25">25</a></span><span class="line"><span class="comment">% --- Determine which syntax is being used ---</span></span></span>
<span class="srcline"><span class="lineno"><a href="43,26" id="srcline26">26</a></span><span class="line"><span class="mxinfo " id="T3:U7"><span class="var type1" id="S11T3U22">nargin1</span> = <span class="mxinfo " id="T3:U9">nargin</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="43,27" id="srcline27">27</a></span><span class="line"><span class="keyword">if</span> (<span class="var type1" id="S11T3U29">nargin1</span>==2),  <span class="comment">% System form</span></span></span>
<span class="srcline"><span class="lineno"><a href="43,28" id="srcline28">28</a></span><span class="line">  [<span class="var type0" id="S12T0U34">A</span>,<span class="var type0" id="S13T0U35">B</span>,<span class="var type0" id="S14T0U36">C</span>,<span class="var type0" id="S15T0U37">D</span>] = ssdata(<span class="var type0" id="S3T0U40">a</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="43,29" id="srcline29">29</a></span><span class="line">  <span class="var type0" id="S17T0U43">K</span>=<span class="var type0" id="S4T0U44">b</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="43,30" id="srcline30">30</a></span><span class="line"><span class="keyword">elseif</span> (<span class="var type1" id="S11T3U48">nargin1</span>==5), <span class="comment">% A,B,C,D matrices</span></span></span>
<span class="srcline"><span class="lineno"><a href="43,31" id="srcline31">31</a></span><span class="line">  <span class="mxinfo " id="T20:U12"><span class="var type1" id="S12T20U52">A</span>=<span class="var type1" id="S3T20U53">a</span></span>; <span class="mxinfo " id="T20:U15"><span class="var type1" id="S13T20U56">B</span>=<span class="mxinfo " id="T20:U17"><span class="var type1" id="S4T20U57">b</span></span></span>; <span class="mxinfo " id="T20:U19"><span class="var type1" id="S14T20U60">C</span>=<span class="mxinfo " id="T20:U21"><span class="var type1" id="S5T20U61">c</span></span></span>; <span class="mxinfo " id="T20:U23"><span class="var type1" id="S15T20U64">D</span>=<span class="mxinfo " id="T20:U25"><span class="var type1" id="S6T20U65">d</span></span></span>; <span class="mxinfo " id="T20:U27"><span class="var type1" id="S17T20U68">K</span>=<span class="var type1" id="S7T20U69">k</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="43,32" id="srcline32">32</a></span><span class="line"><span class="keyword">else</span> error(<span class="string">'Input must be of the form (sys,K) or (A,B,C,D,K)'</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="43,33" id="srcline33">33</a></span><span class="line"><span class="keyword">end</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="43,34" id="srcline34">34</a></span><span class="line"><span class="comment">% compute Nbar</span></span></span>
<span class="srcline"><span class="lineno"><a href="43,35" id="srcline35">35</a></span><span class="line"><span class="mxinfo " id="T3:U30"><span class="var type1" id="S18T3U77">s</span> = <span class="mxinfo " id="T3:U32">size(<span class="var type1" id="S12T20U80">A</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="43,36" id="srcline36">36</a></span><span class="line"><span class="mxinfo " id="T28:U34"><span class="var type1" id="S20T28U84">Z</span> = <span class="mxinfo " id="T28:U36">[zeros([1,<span class="var type1" id="S18T3U92">s</span>]) 1]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="43,37" id="srcline37">37</a></span><span class="line"><span class="var type0" id="S22T0U96">N</span> = <span class="message error" id="M2F68C"><span class="mxinfo " id="T22:U38">inv(<span class="mxinfo " id="T22:U39">[<span class="mxinfo " id="T39:U40"><span class="var type1" id="S12T20U102">A</span>,<span class="mxinfo " id="T20:U42"><span class="var type1" id="S13T20U103">B</span></span></span>;<span class="mxinfo " id="T39:U44"><span class="mxinfo " id="T20:U45"><span class="var type1" id="S14T20U105">C</span></span>,<span class="mxinfo " id="T20:U47"><span class="var type1" id="S15T20U106">D</span></span></span>]</span>)</span>*<span class="mxinfo " id="T29:U49"><span class="var type1" id="S20T28U108">Z</span>'</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="43,38" id="srcline38">38</a></span><span class="line"><span class="var type0" id="S24T0U111">Nx</span> = <span class="var type0" id="S22T0U113"><span class="message error" id="M3F68C">N</span></span>(1:<span class="var type0" id="S18T0U116">s</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="43,39" id="srcline39">39</a></span><span class="line"><span class="var type0" id="S25T0U119">Nu</span> = <span class="var type0" id="S22T0U121"><span class="message error" id="M4F68C">N</span></span>(1+<span class="var type0" id="S18T0U124">s</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="43,40" id="srcline40">40</a></span><span class="line"><span class="var type0" id="S2T0U127">Nbar</span>=<span class="var type0" id="S25T0U129"><span class="message error" id="M5F68C">Nu</span></span> + <span class="var type0" id="S17T0U131">K</span>*<span class="var type0" id="S24T0U132">Nx</span>;</span></span>
</pre>
